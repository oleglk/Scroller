Score-maker usage instructions

==== Score page scans preparation ==============================================
1.1) Scan the score pages as goos as possible.

1.2) Crop tightky on the sides.

1.3) Resize all page images to the same width
(recommended pixel-width:- ~80% of intended screen horizontal resolution)
 * set IMCONVERT {C:\Program Files\Imagemagick_711_3\convert.exe}
 * #### exec $IMCONVERT --version; check the path before script
 * file mkdir RESIZED
 * foreach f [glob {CROPPED/*.jpg}]  {$IMCONVERT $f -resize 800x -quality 92 [file join "RESIZED" [file tail $f]]}
 ****
 * !Having page-width close to screen resolution makes fading alerts visible!*/  

1.4) Mark all score-line top-s and last score-line bottom with the same color.
- use "Paint" application or alike; save results as .gif (or ppm, ?png?)
- place a small quadrant (5*5) of the chosen marker color in the top-left corner
- place the marks "tightly" close to the related score lines - as close as possible; just enough to include finger numbers (don't leave spare space beyound the upper/lower pixels of the most distant finger numbers in this line) 
- the rest of this document assumes the resulting images are saved under "MARKED\" subdirectory as GIF files


==== Auto-generating score templates ===========================================
2.1) Put all page scans (with line markings) for the score into one directory and start Tcl/Tk graphical shell (usually "wish") in its parent directory.
  >>>>> Example (Windows cmd):
  C:\Oleg\GitWork\Scroller\Scores\V02>md Scores
  C:\Oleg\GitWork\Scroller\Scores\V02>copy MARKED\Vals_by_Petrov__*.gif Scores\
  MARKED\Vals_by_Petrov__01.gif
  MARKED\Vals_by_Petrov__02.gif
  MARKED\Vals_by_Petrov__03.gif
          3 file(s) copied.

  C:\Oleg\GitWork\Scroller\Scores\V02>start C:\Oleg\Tools\TCL\freewrap_wish.exe
  C:\Oleg\GitWork\Scroller\Scores\V02>

2.2) (In Tcl shell) Load score-maker code
source C:/Oleg/GitWork/Scroller/Code/make_score.tcl

2.3) (In Tcl shell) Invoke the score-maker
make_score_file  "Vals_by_Petrov"  [list "Scores/Vals_by_Petrov__01.gif" "Scores/Vals_by_Petrov__02.gif" "Scores/Vals_by_Petrov__03.gif"]

>>>>>> Sample screen output:
  (V02) 3 % make_score_file  "Vals_by_Petrov"  [list "Scores/Vals_by_Petrov__01.gif" "Scores/Vals_by_Petrov__02.gif" "Scores/Vals_by_Petrov__03.gif"]
  Log file for score 'Vals_by_Petrov' goes into 'Scores/Vals_by_Petrov__score_maker_log.txt'
  Begin processing score page 'pg01', path: 'Scores/Vals_by_Petrov__01.gif'

  ... Please wait ...
  End processing score page 'pg01', path: 'Scores/Vals_by_Petrov__01.gif', width=2000, height=1292
  Begin processing score page 'pg02', path: 'Scores/Vals_by_Petrov__02.gif'

  ... Please wait ...
  End processing score page 'pg02', path: 'Scores/Vals_by_Petrov__02.gif', width=2000, height=1286
  Begin processing score page 'pg03', path: 'Scores/Vals_by_Petrov__03.gif'

  ... Please wait ...
  End processing score page 'pg03', path: 'Scores/Vals_by_Petrov__03.gif', width=2000, height=1293
  Done generting description file for score 'Vals_by_Petrov' into 'Scores/Vals_by_Petrov__straight_out.html'...
0
====
Several facts to be learned from the above:
- the detailed log file for score 'Vals_by_Petrov' could be found  in  'Scores/Vals_by_Petrov__score_maker_log.txt';
- the score has 3 original pages; all processed succesfully
- the resulting description file template is: 'Scores/Vals_by_Petrov__straight_out.html'.


==== Verify validity of the autogenerated score ====
3.1) Provide Scroller code files alongside the autogenerated score
  >>>>> Example (Windows cmd):
  C:\Oleg\GitWork\Scroller\Scores\V02>md .\Code
  C:\Oleg\GitWork\Scroller\Scores\V02>copy ..\..\Code\*.* .\Code\
..\..\Code\assemble.tcl
..\..\Code\img_scroll.js
..\..\Code\make_score.tcl
..\..\Code\ModalDialog.js
..\..\Code\PlayOrder.js
..\..\Code\run__make_score.tcl
..\..\Code\ScoreImgLayout.js
..\..\Code\ScrollerCommonUtils.js
        8 file(s) copied.

3.2) Try to open the autogenerated score in a browser:
- Open a new tab in the browser
- In this Tab open the browser console (In Firefox - press Ctrl-Shift-i), resize it to approximately 1/4 of the window height
- (important) Return input focus to the non-console field in the browser tab - click on it with the mouse left button
- In FireFox, Edge, etc, press Ctrl-O, navigate to the relevant directory and choose the autogenerated score (in our example C:\Oleg\GitWork\Scroller\Scores\V02\Scores\Vals_by_Petrov__straight_out.html)
- You should see the chosen score in the background and the tempo prompt for it in the foreground
- Examine the console for errors; ignore "Invalid URI. Load of media resource failed" messages
---- assuming no errors detected ----
- Enter the tempo of, say, 60 beats/sec; with the default line duration of 3 beats imprinted in autogenerated score, each line is expected to "stay" for 3 seconds.
- Start scrolling (right click); watch the scrolling of one line at a time every 3 seconds. Again, the default number of lines to jump in one step - one line - is imprinted in autogenerated score.
-- Do verify all the lines are "played" in the straight order from the first to the last.
-- Do verify all the lines are correctly positioned.
-- Pay attention at the progress indicator (countdown) that appears near the currently "played" line; while it isn't (by design) aligned with the current line center, its vertical position should unambiguously tell which line is the current.

==== If (3) worked correctly, assume autogeneration was successful. ====
==== From now on the line-location marking in the score isn't needed any more ===


==== Return to unmark score images ====
4.1) Copy the relevant unmarked score-page images into the directory of autogenerated score file
  >>>>> Example (Windows cmd):
  C:\Oleg\GitWork\Scroller\Scores\V02>copy RESIZED\Vals_by_Petrov__*.jpg Scores\
  RESIZED\Vals_by_Petrov__01.jpg
  RESIZED\Vals_by_Petrov__02.jpg
  RESIZED\Vals_by_Petrov__03.jpg
        3 file(s) copied.

4.2) Change score-page images' extensions in the autogenerated score file from .gif to .jpg
- open the autogenerated score file in a text editor
- find the file-paths' array - search for "g_pageImgPathsMap":
  >>>>> Example of file-paths' array - as generated:
  var g_pageImgPathsMap = new Map([
  ["pg01", "Vals_by_Petrov__01.gif"],
  ["pg02", "Vals_by_Petrov__02.gif"],
  ["pg03", "Vals_by_Petrov__03.gif"],
  ]);
- replace the image-file extensions
  >>>>> Example of file-paths' array - after extension replacement:
  var g_pageImgPathsMap = new Map([
  ["pg01", "Vals_by_Petrov__01.jpg"],
  ["pg02", "Vals_by_Petrov__02.jpg"],
  ["pg03", "Vals_by_Petrov__03.jpg"],
  ]);

4.3) Verify that the Scroller works correctly after extension change - perform the procedures from (3.2).


==== Ensure the score images are comfortably visible with all the details ====
!!! This stage is better performed with the display used while playing the piano; viewed from the real-world distance - e.g. by the user sitting near the piano keyboard !!!

(5.1) Restart the Scroller in manual-step mode and carefully examinescore-images' content.